this is the calculation apart
